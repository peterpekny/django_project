<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOOMER Game</title>
    <style>
        .board {
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgb(9, 38, 93);
            font-family: monospace;
            line-height: 1.0;
            border: 1px solid rgb(14, 14, 98);
            margin: auto;
        }

        .sky {
            color: aqua;
        }

        .score {
            text-align: center;
            font-size: 1.5rem;
            margin-top: 10px;
        }

        .game-over {
            font-size: 2rem;
            color: red;
            text-align: center;
        }
    </style>
</head>

<body>
    <script>
        let velkost_X = 50;  // Pociatocna sirka
        let velkost_Y = 20;  // Pociatocna vyska
        let backGround_value = "‚ÄÖ‚ÄÖ";  // Obloha
        let building_value = "‚îú‚î§"; // Budova
        let strecha = "‚îå‚îê"; // strecha
	    let plane = "<üõ∏>";  // Lietadlo
        let bombSymbol = "\\/"; // Bomba
        let explosionSymbol = "üî•"; // Znak v√Ωbuchu
        let min_building = 0;  // aka vysoka ma byt budova (min)
        let max_building = 9;  // aka vysoka ma byt budova (max)
        let obmedzenie_bomb = 3  // kolko bomb ma ist naraz
        let cas_jedneho_kroku = 240; // cas na jeden krok hry
        let planeX = velkost_X - plane.length; // Zaƒçiatoƒçn√° poz√≠cia lietadla (sprava)
        let planeY = 0; // Zaƒç√≠na na vrchole mapy
        
        var audio = new Audio('bomb2.mp3'); // set sound for bomb
        var audio1 = new Audio('bomb3.wav');
        var audio2 = new Audio('drop_bomb_sound.wav'); 


        let gameOver = false;
        let score = 0;
        let playBoard = []; // Definujeme pociatocne pole pre hru
        let bombs = [];  // Pole pre bomby (viacero b√¥mb naraz)
        let explosions = []; // Uchov√°va v√Ωbuchy, ktor√© sa zobrazia na kr√°tky ƒças

        // Inicializ√°cia hracieho pola - vyrovbime pole o velkost_x a velkost_y
        for (let y = 0; y < velkost_Y; y++) {
            playBoard[y] = [];  // struhneme pole do pole (jednotlive riadky) 2D pole 
            for (let x = 0; x < velkost_X; x++) {
                playBoard[y][x] = backGround_value;  // Vsetko sa na uvod vyplni oblohou
                console.log(playBoard)  // Pro ucebni potreby
            }
            console.log(playBoard)  // Pro ucebni potreby
        }

        // N√°hodn√© ƒç√≠slo v rozmedz√≠ - min / max
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // Generovanie budov
        function generateBuildings() {
            for (let x = 0; x < velkost_X; x++) {
                let randomHeight = getRandomInt(min_building, max_building);
                if (randomHeight > 0) {
                    playBoard[velkost_Y - randomHeight][x] = strecha; //
                }
                for (let y = velkost_Y - 1; y > velkost_Y - randomHeight; y--) {
                    playBoard[y][x] = building_value;
                    console.log(playBoard)  // Pro ucebni potreby
                }
                console.log(playBoard)  // Pro ucebni potreby
            }
        }



        // Vykreslenie hracej plochy
        function renderBoard() {
            if (gameOver) {
                document.body.innerHTML = '<div class="game-over">GAME OVER</div>';
                return;
            }

            let boardHtml = '<div class="board">';
            for (let y = 0; y < playBoard.length; y++) {
                for (let x = 0; x < playBoard[y].length; x++) {
                    // Kontrola ƒçi je v poli lietadlo
                    if (y === planeY && x >= planeX && x < planeX + plane.length) {
                        boardHtml += plane[x - planeX]; // Zobrazenie lietadla
                    } 
                    // Kontrola ƒçi je na poli bomba
                    else if (bombs.some(b => b.y === y && b.x === x)) {
                        boardHtml += bombSymbol; // Bomba
                    }
                    // Kontrola ƒçi je na poli v√Ωbuch
                    else if (explosions.some(e => e.y === y && e.x === x)) {
                        boardHtml += explosionSymbol; // V√Ωbuch
                    } 
                    else {
                        boardHtml += playBoard[y][x]; // Ostatn√© ƒçasti mapy
                    }
                }
                boardHtml += "<br>";
            }
            boardHtml += '</div>';
            boardHtml += '<div class="score">Score: ' + score + '</div>'; // Zobrazenie sk√≥re
            document.body.innerHTML = boardHtml;
        }

        // Pohyb lietadla
        function movePlane() {
            if (gameOver) return;

            // Detekcia kol√≠zie s budovou
            for (let x = 0; x < plane.length; x++) {
                if (planeY < velkost_Y && playBoard[planeY][planeX + x] !== backGround_value) {
                    gameOver = true;
                    renderBoard();
                    return;
                }
            }

            if (planeY % 2 === 0) {
                planeX--; // Sprava doƒæava
                if (planeX < 0) {
                    planeX = 0;
                    planeY++;
                }
            } else {
                planeX++; // Zƒæava doprava
                if (planeX > velkost_X - plane.length) {
                    planeX = velkost_X - plane.length;
                    planeY++;
                }
            }
            if (planeY >= velkost_Y) {
                planeY = 0; // Znova na vrchole
            }
            renderBoard();
        }

        // Pohyb bomby
        function moveBombs() {
            bombs = bombs.filter(b => {
                b.y++; // Bomba pad√° dolu
                if (b.y >= velkost_Y) return false; // Ak bomba vyjde z poƒæa, odstr√°ni sa

                // Kontrola zasiahnutia budovy
                if (playBoard[b.y][b.x] !== backGround_value) {
                    playBoard[b.y][b.x] = backGround_value; // Zniƒçenie budovy
                    explosions.push({x: b.x, y: b.y}); // Zaznamenanie v√Ωbuchu
                    audio.play(); 
                    score++; // Zv√Ω≈°enie sk√≥re
                    setTimeout(() => {
                        explosions = explosions.filter(e => e.x !== b.x || e.y !== b.y); // Odstr√°nenie v√Ωbuchu po sekunde
                        renderBoard();
                    }, 1000);
                    return false; // Bomba sa odstr√°ni po z√°sahu
                }
                return true; // Bomba pokraƒçuje v p√°de
            });
        }

        // Spustenie bomby
        function dropBomb() {
            if (bombs.length < obmedzenie_bomb) { // Obmedzenie na dve bomby naraz
                let bombX = planeX + Math.floor(plane.length / 2);
                let bombY = planeY + 1;
                bombs.push({x: bombX, y: bombY});
		audio2.play();
            }
        }

        // Funkcia na prehratie zvuku v√Ωbuchu
        function playExplosionSound() {
            let explosionSound = document.getElementById('bomb.mp3');
            explosionSound.play();
        }


        // Ovl√°danie pomocou kl√°ves
        window.addEventListener('keydown', function (event) {
            if (event.key === ' ' && !gameOver) {
                dropBomb(); // Zhadzovanie bomby
            }
        });

        // Generovanie budov
        generateBuildings();

        // Anim√°cia
        setInterval(() => {
            movePlane();
            moveBombs();
        }, cas_jedneho_kroku);

        renderBoard();
    </script>
</body>

</html>

